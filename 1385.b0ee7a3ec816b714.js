"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1385],{1385:(Pt,U,h)=>{h.r(U),h.d(U,{AuthsPage:()=>Ft});var I=h(467),A=h(177),p=h(4341),f=h(5985),B=h(5079),y=h(5873),e=h(3953),a=h(9842),v=h(8880),S=(h(1635),h(3726),h(6766),h(617));h(4261),h(9483);const Tt={provide:p.cz,useExisting:(0,e.Rfq)(()=>k),multi:!0};let k=(()=>{var n;class o extends p.zX{}return n=o,(0,a.A)(o,"\u0275fac",(()=>{let r;return function(i){return(r||(r=e.xGo(n)))(i||n)}})()),(0,a.A)(o,"\u0275dir",e.FsC({type:n,selectors:[["ion-input","type","number","max","","formControlName",""],["ion-input","type","number","max","","formControl",""],["ion-input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(t,i){2&t&&e.BMQ("max",i._enabled?i.max:null)},features:[e.Jv_([Tt]),e.Vt3]})),o})();const xt={provide:p.cz,useExisting:(0,e.Rfq)(()=>w),multi:!0};let w=(()=>{var n;class o extends p.VZ{}return n=o,(0,a.A)(o,"\u0275fac",(()=>{let r;return function(i){return(r||(r=e.xGo(n)))(i||n)}})()),(0,a.A)(o,"\u0275dir",e.FsC({type:n,selectors:[["ion-input","type","number","min","","formControlName",""],["ion-input","type","number","min","","formControl",""],["ion-input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(t,i){2&t&&e.BMQ("min",i._enabled?i.min:null)},features:[e.Jv_([xt]),e.Vt3]})),o})(),Ut=(()=>{var n;class o extends v.Kb{constructor(){super(S.TN)}}return n=o,(0,a.A)(o,"\u0275fac",function(t){return new(t||n)}),(0,a.A)(o,"\u0275prov",e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})),o})(),Mt=(()=>{var n;class o extends v.Kb{constructor(){super(S.eE)}}return n=o,(0,a.A)(o,"\u0275fac",function(t){return new(t||n)}),(0,a.A)(o,"\u0275prov",e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})),o})();var C=h(5621),x=h(7043),kt=h(4412),b=h(4262),wt=h(9570);let Xt=(()=>{var n;class o{constructor(t,i,l){this.fireAuth=t,this.jobService=i,this.firestore=l,this._uid=new kt.t(null)}login(t,i){var l=this;return(0,I.A)(function*(){try{const u=yield(0,C.x9)(l.fireAuth,t,i);return l.setUserData(u.user.uid),u}catch(u){throw u}})()}signInWithGoogle(){var t=this;return(0,I.A)(function*(){const i=new x.HF;try{const u=(yield(0,C.df)(t.fireAuth,i)).user,_={uid:u.uid,email:u.email,displayName:u.displayName,photoURL:u.photoURL};yield t.jobService.setDocument(`users/${u.uid}`,_),t._uid.next(u.uid),console.log("Google Sign-In successful:",u)}catch(l){throw console.error("Error during Google Sign-In:",l),l}})()}signUp(t){var i=this;return(0,I.A)(function*(){try{if(!t.username)throw new Error("Username is required");if(yield i.checkUsernameExists(t.username))throw new Error("Username is already taken");const u=yield(0,x.eJ)(i.fireAuth,t.email,t.password),_={userName:t.username,email:t.email,uid:u.user.uid};return yield i.jobService.setDocument(`users/${u.user.uid}`,_),u.user.uid}catch(l){throw l}})()}resetPassword(t){var i=this;return(0,I.A)(function*(){try{return yield(0,x.J1)(i.fireAuth,t)}catch(l){throw l}})()}getId(){const t=(0,C.xI)();return this.currentUser=t.currentUser,this.currentUser?(console.log(`Current User's name: ${this.currentUser.displayName}`),this.currentUser.uid):(console.log("No user is currently logged in."),null)}setUserData(t){this._uid.next(t)}logOut(){var t=this;return(0,I.A)(function*(){try{return yield(0,C.xI)().signOut(),t._uid.next(null),!0}catch(i){throw i}})()}checkAuth(){return new Promise((t,i)=>{(0,C.hg)(this.fireAuth,l=>{console.log(l),t(l)})})}getUserData(t){var i=this;return(0,I.A)(function*(){const l=yield i.jobService.getDocById(`users/${t}`);if(l.exists())return l.data();throw new Error("No such document exists")})()}getUserDataByUsername(t){var i=this;return(0,I.A)(function*(){const l=(0,b.rJ)(i.firestore,"users"),u=(0,b.P)(l,(0,b._M)("userName","==",t)),g=yield(0,b.GG)(u);return g.empty?null:g.docs[0].data()})()}checkUsernameExists(t){var i=this;return(0,I.A)(function*(){const l=(0,b.rJ)(i.firestore,"users"),u=(0,b.P)(l,(0,b._M)("userName","==",t));return!(yield(0,b.GG)(u)).empty})()}addUserDataToFirestore(t){var i=this;return(0,I.A)(function*(){(0,b.H9)(i.firestore,`users/${t.uid}`)})()}}return(n=o).\u0275fac=function(t){return new(t||n)(e.KVO(C.Nj),e.KVO(wt.L),e.KVO(b._7))},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),o})();function Bt(n,o){if(1&n){const r=e.RV6();e.qex(0),e.j41(1,"ion-card-header")(2,"ion-toolbar",4)(3,"ion-title"),e.EFF(4,"Login"),e.k0s(),e.j41(5,"ion-buttons",5)(6,"ion-button",6),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.changeLogintype())}),e.nrm(7,"ion-icon",7),e.k0s()()()(),e.j41(8,"ion-card-content")(9,"form",8),e.bIt("ngSubmit",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.onSubmit(i.logForm))}),e.j41(10,"div",9)(11,"ion-input",10),e.nrm(12,"ion-icon",11),e.k0s()(),e.j41(13,"div",9)(14,"ion-input",12)(15,"ion-button",13),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.hide=!i.hide)}),e.nrm(16,"ion-icon",14),e.k0s()()(),e.j41(17,"ion-buttons",15)(18,"ion-button",16),e.nrm(19,"ion-icon",17),e.EFF(20," Login "),e.k0s(),e.j41(21,"ion-button",18),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.resetForm(i.logForm))}),e.nrm(22,"ion-icon",19),e.EFF(23," Reset "),e.k0s()()(),e.j41(24,"ion-label",20)(25,"p",21),e.EFF(26,"Forgot Password"),e.k0s(),e.j41(27,"p",22),e.EFF(28,"Don't have an account? "),e.j41(29,"span",23),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.changeSegment({detail:{value:"signup"}}))}),e.EFF(30,"Sign Up"),e.k0s()()(),e.nrm(31,"ion-alert",24),e.j41(32,"ion-list",25)(33,"ion-chip",26),e.EFF(34,"OR"),e.k0s()(),e.j41(35,"ion-row",27)(36,"ion-button",28),e.nrm(37,"ion-img",29),e.k0s()()(),e.bVm()}if(2&n){let r;const t=e.XpG();e.R7$(7),e.Y8G("name",t.mail?"mail":"person-circle"),e.R7$(2),e.Y8G("formGroup",t.logForm),e.R7$(2),e.Y8G("label",t.mail?"Email Address":"Username")("placeholder",t.mail?"Enter Your Email Address":"Enter Your Username")("type",t.mail?"email":"text")("errorText",t.mail?"Enter a proper email address":"Enter a proper username"),e.R7$(),e.Y8G("name",t.mail?"mail":"person-circle"),e.R7$(2),e.Y8G("type",t.hide?"password":"text")("errorText",null!=(r=t.logForm.get("password"))&&r.hasError("minlength")?"Password MUST be at least 8 characters long":"Enter a proper password"),e.R7$(2),e.Y8G("name",t.hide?"eye-off":"eye-sharp"),e.R7$(2),e.Y8G("disabled",!t.logForm.valid),e.R7$(3),e.Y8G("disabled",t.logForm.pristine),e.R7$(10),e.Y8G("buttons",t.alertButtons)("inputs",t.alertInputs)}}function Rt(n,o){if(1&n){const r=e.RV6();e.qex(0),e.j41(1,"ion-toolbar",4)(2,"ion-title"),e.EFF(3,"Sign Up"),e.k0s(),e.j41(4,"ion-button",30),e.nrm(5,"ion-img",29),e.k0s()(),e.j41(6,"ion-card-content")(7,"form",8),e.bIt("ngSubmit",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.onSubmit(i.signUpForm))}),e.j41(8,"div",9)(9,"ion-input",31),e.nrm(10,"ion-icon",32),e.k0s()(),e.j41(11,"div",9)(12,"ion-input",33),e.nrm(13,"ion-icon",34),e.k0s()(),e.j41(14,"div",9)(15,"ion-input",12)(16,"ion-button",35),e.nrm(17,"ion-icon",36),e.k0s(),e.j41(18,"ion-button",13),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.hide=!i.hide)}),e.nrm(19,"ion-icon",14),e.k0s()()(),e.j41(20,"div",9)(21,"ion-input",37)(22,"ion-button",35),e.nrm(23,"ion-icon",36),e.k0s(),e.j41(24,"ion-button",13),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.hide=!i.hide)}),e.nrm(25,"ion-icon",14),e.k0s()()(),e.j41(26,"ion-buttons",15)(27,"ion-button",16),e.nrm(28,"ion-icon",38),e.EFF(29," Sign Up "),e.k0s(),e.j41(30,"ion-button",18),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.resetForm(i.signUpForm))}),e.nrm(31,"ion-icon",19),e.EFF(32," Reset "),e.k0s()()(),e.j41(33,"ion-label",20)(34,"p",22),e.EFF(35,"Already have an account? "),e.j41(36,"span",23),e.bIt("click",function(){e.eBV(r);const i=e.XpG();return e.Njj(i.changeSegment({detail:{value:"login"}}))}),e.EFF(37,"Log In"),e.k0s()()()(),e.bVm()}if(2&n){const r=e.XpG();e.R7$(7),e.Y8G("formGroup",r.signUpForm),e.R7$(2),e.Y8G("errorText",r.getErrorMessage(r.signUpForm.get("username"))),e.R7$(3),e.Y8G("errorText",r.getErrorMessage(r.signUpForm.get("email"))),e.R7$(3),e.Y8G("type",r.hide?"password":"text")("errorText",r.getErrorMessage(r.signUpForm.get("password"))),e.R7$(4),e.Y8G("name",r.hide?"eye-off":"eye-sharp"),e.R7$(2),e.Y8G("type",r.hide?"password":"text")("errorText",r.getErrorMessage(r.signUpForm.get("confirmPassword"))),e.R7$(4),e.Y8G("name",r.hide?"eye-off":"eye-sharp"),e.R7$(2),e.Y8G("disabled",!r.signUpForm.valid),e.R7$(3),e.Y8G("disabled",r.signUpForm.pristine)}}let Ft=(()=>{var n;class o{constructor(t,i,l,u,g){this.alertController=t,this.navController=i,this.loadingController=l,this.toastController=u,this.authService=g,this.mail=!1,this.hide=!0,this.selectedCategory="login",(0,B.a)({eye:y.y5U,"eye-off":y.zsm,"eye-sharp":y.Ag4,"lock-closed":y.AaQ,"log-in":y.E8l,"log-in-sharp":y.Kt,mail:y.kiB,"person-circle":y.Ihr,"refresh-circle":y.S6C,"trail-sign":y.s8K,"logo-google":y.FEl})}ngOnInit(){this.logForm=new p.gE({username:new p.MJ("",[p.k0.required]),password:new p.MJ("",[p.k0.required,p.k0.minLength(8)])}),this.signUpForm=new p.gE({username:new p.MJ("",[p.k0.required]),email:new p.MJ("",[p.k0.required,p.k0.email]),password:new p.MJ("",[p.k0.required,p.k0.minLength(8)]),confirmPassword:new p.MJ("",[p.k0.required,p.k0.minLength(8),this.matchValidator("password")])}),this.alertButtons=[{text:"Cancel"},{text:"Reset",handler:t=>{this.resetPassword(t.email)}}],this.alertInputs=[{name:"email",placeholder:"Email Address",type:"email"}]}changeLogintype(){this.mail=!this.mail;const t=this.logForm.get("username");this.mail?null==t||t.setValidators([p.k0.required,p.k0.email]):null==t||t.setValidators([p.k0.required]),null==t||t.updateValueAndValidity()}changeSegment(t){this.selectedCategory=t.detail.value,this.resetForm("login"===this.selectedCategory?this.logForm:this.signUpForm)}onSubmit(t){var i=this;return(0,I.A)(function*(){const l=yield i.createLoading();if(t.valid)if(yield l.present(),t===i.logForm){const{username:u,password:g}=i.logForm.value;i.login({username:u,password:g}).finally(()=>l.dismiss())}else if(t===i.signUpForm){const{email:u,username:g,password:_}=i.signUpForm.value;i.signUp({email:u,username:g,password:_}).finally(()=>l.dismiss())}})()}login(t){var i=this;return(0,I.A)(function*(){try{if(i.mail)yield i.authService.login(t.username,t.password);else{const l=yield i.authService.getUserDataByUsername(t.username);if(!l)throw new Error("User does not exist");yield i.authService.login(l.email,t.password)}i.resetForm(i.logForm),i.presentToast(`Welcome ${t.username}`,"tertiary"," top"),i.navController.navigateRoot("tabs/home")}catch(l){i.handleAuthError(l)}})()}signUp(t){var i=this;return(0,I.A)(function*(){try{yield i.authService.signUp({email:t.email,username:t.username,password:t.password}),i.selectedCategory="login",i.resetForm(i.signUpForm),i.presentAlert(`Account created successfully! Welcome, ${t.username}!`)}catch(l){i.handleAuthError(l)}})()}signInWithGoogle(){return(0,I.A)(function*(){})()}resetPassword(t){var i=this;return(0,I.A)(function*(){try{yield i.authService.resetPassword(t),i.presentAlert(`Password reset email sent to ${t}`)}catch(l){i.handleAuthError(l)}})()}createLoading(){var t=this;return(0,I.A)(function*(){return t.loadingController.create({message:"Please wait...",spinner:"crescent",backdropDismiss:!1})})()}resetForm(t){t.reset()}matchValidator(t){return i=>{var l;if(!i.parent)return null;const u=null===(l=i.parent.get(t))||void 0===l?void 0:l.value;return i.value===u?null:{mismatch:!0}}}getErrorMessage(t){return null!=t&&t.hasError("required")?"This field is required":null!=t&&t.hasError("email")?"Please enter a valid email":null!=t&&t.hasError("minlength")?`Minimum ${null===(i=t.errors)||void 0===i?void 0:i.minlength.requiredLength} characters required`:null!=t&&t.hasError("maxlength")?`Maximum ${null===(l=t.errors)||void 0===l?void 0:l.maxlength.requiredLength} characters allowed`:null!=t&&t.hasError("pattern")?"Invalid input pattern":null!=t&&t.hasError("mismatch")?"Passwords do not match":"";var i,l}handleAuthError(t){let l="An error occurred. Please try again.";switch(t.code){case"auth/wrong-password":l="Incorrect password. Please try again.";break;case"auth/user-not-found":l="User not found. Please check your credentials.";break;case"auth/email-already-in-use":l="This email is already registered. Please use a different email.";break;case"auth/invalid-email":l="Invalid email address. Please enter a valid email.";break;case"auth/missing-email":l="Invalid entry. Please enter a valid email.";break;case"auth/invalid-credential":case"auth/too-many-requests":l="Invalid email address and password combination Please try again.";break;default:l=t.message||l}this.presentToast(l,"danger","bottom")}presentAlert(t){var i=this;return(0,I.A)(function*(){yield(yield i.alertController.create({header:"Notification",message:t,buttons:["OK"],mode:"ios"})).present()})()}presentToast(t,i,l){var u=this;return(0,I.A)(function*(){yield(yield u.toastController.create({message:t,duration:2e3,color:i,position:l})).present()})()}}return(n=o).\u0275fac=function(t){return new(t||n)(e.rXU(Ut),e.rXU(v.q9),e.rXU(f.Xi),e.rXU(Mt),e.rXU(Xt))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-auths"]],standalone:!0,features:[e.aNF],decls:6,vars:3,consts:[[3,"fullscreen"],[1,"ion-justify-content-center","ion-align-items-center"],["size-md","12","size-lg","10","sizeSm","12"],[4,"ngIf"],[1,"ion-justify-content-evenly"],["slot","end"],[3,"click"],[3,"name"],[3,"ngSubmit","formGroup"],[1,"ion-padding"],["formControlName","username","label-placement","floating","fill","outline",3,"label","placeholder","type","errorText"],["slot","end","size","medium","aria-hidden","true",3,"name"],["formControlName","password","label","Password","label-placement","floating","fill","outline","placeholder","Enter Your Password",3,"type","errorText"],["slot","end","aria-label","Toggle password visibility","fill","clear",3,"click"],["slot","icon-only",3,"name"],[1,"ion-margin","ion-justify-content-evenly"],["slot","start","fill","clear","shape","round","type","submit",3,"disabled"],["slot","end","name","log-in-sharp"],["slot","end","shape","round","fill","clear",3,"click","disabled"],["slot","start","name","refresh-circle"],[1,"ion-text-wrap"],["id","forgotPass",1,"forgotPas","ion-text-center","ion-margin"],[1,"alt"],[1,"span",3,"click"],["trigger","forgotPass","header","Enter your Email Address","mode","ios",3,"buttons","inputs"],["lines","none",1,"section-title-wrap","ion-text-center"],[1,"section-title"],[1,"ion-justify-content-center"],["fill","clear","shape","round",1,"ion-text-wrap","ion-margin"],["src","assets/google.png","alt","Google Logo","slot","icon-only"],["fill","clear","shape","round","slot","end",1,"ion-text-wrap","ion-margin"],["formControlName","username","label","Username","label-placement","floating","fill","outline","placeholder","Enter Your Username","type","text",3,"errorText"],["slot","start","name","person-circle","aria-hidden","true"],["formControlName","email","label","Email Address","label-placement","floating","fill","outline","placeholder","Enter Your Email Address","type","email",3,"errorText"],["slot","start","name","mail","aria-hidden","true"],["slot","start","fill","clear"],["name","lock-closed"],["formControlName","confirmPassword","label","Confirm Password","label-placement","floating","fill","outline","placeholder","Confirm Your Password",3,"type","errorText"],["slot","end","name","trail-sign"]],template:function(t,i){1&t&&(e.j41(0,"ion-content",0)(1,"ion-grid")(2,"ion-row",1)(3,"ion-col",2),e.DNE(4,Bt,38,14,"ng-container",3)(5,Rt,38,11,"ng-container",3),e.k0s()()()()),2&t&&(e.Y8G("fullscreen",!0),e.R7$(4),e.Y8G("ngIf","login"===i.selectedCategory),e.R7$(),e.Y8G("ngIf","signup"===i.selectedCategory))},dependencies:[f.KW,f.ZB,f.nf,f.he,f.I9,f.hU,f.ME,f.QW,f.Jm,f.iq,f.lO,f.ln,f.W9,f.BC,f.ai,A.MD,A.bT,p.YN,p.qT,p.BC,p.cb,f.$w,f.Zy,p.X1,p.j4,p.JD],styles:["ion-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{cursor:pointer;color:var(--ion-color-primary)}ion-content[_ngcontent-%COMP%]   .forgotPas[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-primary-shade);font-weight:600;cursor:pointer}ion-content[_ngcontent-%COMP%]   .alt[_ngcontent-%COMP%]{font-weight:500;text-align:center;margin-bottom:1rem}ion-content[_ngcontent-%COMP%]   .alt[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer;color:var(--ion-color-primary)}ion-content[_ngcontent-%COMP%]   ion-chip.section-title[_ngcontent-%COMP%]{border:solid 2px var(--ion-color-primary-shade)}ion-content[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:24px;height:24px}"]}),o})()}}]);